<div>
    <div class="table-responsive table-card mb-1">
        <table class="table">
            <thead class="table-light text-muted">
                <tr>
                    <th class="sort" (click)="onSort('nome')">Nome</th>
                    <th class="sort" (click)="onSort('cpf')">Cpf</th>
                    <th class="sort" (click)="onSort('email')">Email</th>
                    <th class="sort" (click)="onSort('perfis')">Perfil</th>
                    <th class="sort">Ações</th>
                </tr>
            </thead>
            <tbody>
                @for(data of usuarios; track $index){
                <tr id="c_{{data.id}}">
                    <td>
                        <ngb-highlight [result]="data.nome">
                            {{ data.nome }}
                        </ngb-highlight>
                    </td>
                    <td>
                        <ngb-highlight [result]="data.cpf">
                            {{ data.cpf | cpf }}
                        </ngb-highlight>
                    </td>
                    <td>
                        <ngb-highlight [result]="data.email">
                            {{ data.email }}
                        </ngb-highlight>
                    </td>
                    <td class="status">
                        @for(dataPerfil of data.perfis; track $index){
                            <span 
                                class="badge text-uppercase"
                                [ngClass]=" { 'bg-success-subtle text-success': dataPerfil === 1, 'bg-primary-subtle text-primary': dataPerfil === 2, 'bg-dark-subtle text-body': dataPerfil === 3 }">
                                {{  getPerfil(dataPerfil) }}
                            </span>
                        }
                    </td>
                    <td>
                        <ul class="list-inline hstack gap-2 mb-0">
                            <li class="list-inline-item edit grid-action" ngbTooltip="Editar" placement="top">
                                <a class="text-primary d-inline-block edit-item-btn" (click)="openModal(content, $index)">
                                    <i class="ri-pencil-fill fs-16"></i>
                                </a>
                            </li>
                            <li class="list-inline-item me-0 grid-action" ngbTooltip="Remover" placement="top">
                                <a class="text-danger d-inline-block remove-item-btn" (click)="delete(data)">
                                    <i class="ri-delete-bin-5-fill fs-16"></i>
                                </a>
                            </li>
                        </ul>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
    <div class="row justify-content-md-between align-items-md-center">
        <div class="col col-sm-6">
            <div class="dataTables_info mb-2" id="tickets-table_info" role="status" aria-live="polite" *ngIf="allUsuarios.length > 0">
                Exibindo
                {{paginationService.startIndex}} a
                {{paginationService.endIndex}} de {{allUsuarios.length}}
                registros
            </div>
        </div>
        <div class="col col-sm-6">
            <div class="text-sm-right float-end listjs-pagination">
                <ngb-pagination 
                    [collectionSize]="allUsuarios.length" 
                    [(page)]="paginationService.page" 
                    (pageChange)="changePage()"
                    [pageSize]="paginationService.pageSize">
                </ngb-pagination>
            </div>
        </div>
    </div>
</div>

<ng-template #content role="document" let-modal>
    <app-usuario-form 
        [modal]="modal" 
        [usuario]="usuarioEdit"
        (onAddUsuario)="addUsuario($event)">
    </app-usuario-form>    
</ng-template>